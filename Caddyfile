www.zenzerobiogas.com {
	# Automatically handles HTTPS with Let's Encrypt

	# API endpoint - reverse proxy to backend
	handle /api/* {
		reverse_proxy localhost:3001
	}

	# WebSocket endpoint for MQTT
	handle_path /mqtt {
		reverse_proxy localhost:8084 {
			header_up Upgrade {http.request.header.Upgrade}
			header_up Connection {http.request.header.Connection}
		}
	}

	# Frontend - reverse proxy to Nginx
	handle {
		reverse_proxy localhost:8888
	}

	# Enable gzip compression
	encode gzip

	# Security headers
	header {
		X-Frame-Options "SAMEORIGIN"
		X-Content-Type-Options "nosniff"
		X-XSS-Protection "1; mode=block"
		-Server
	}
}

# Redirect non-www to www
zenzerobiogas.com {
	redir https://www.zenzerobiogas.com{uri} permanent
}
