www.zenzerobiogas.com {
	# Automatically handles HTTPS with Let's Encrypt

	# Chat API endpoint - reverse proxy to CSK API
	handle /api/chat* {
		reverse_proxy localhost:3010
	}

	# API endpoint - reverse proxy to backend
	handle /api/* {
		reverse_proxy localhost:3001
	}

	# WebSocket endpoint for MQTT (must use HTTP/1.1)
	@websocket {
		path /mqtt*
		header Connection *Upgrade*
		header Upgrade websocket
	}
	reverse_proxy @websocket localhost:8085 {
		transport http {
			versions 1.1
		}
	}

	# Frontend - reverse proxy to Nginx
	handle {
		reverse_proxy localhost:8888
	}

	# Enable gzip compression
	encode gzip

	# Security headers
	header {
		X-Frame-Options "SAMEORIGIN"
		X-Content-Type-Options "nosniff"
		X-XSS-Protection "1; mode=block"
		-Server
	}
}

# Redirect non-www to www
zenzerobiogas.com {
	redir https://www.zenzerobiogas.com{uri} permanent
}

# CSK Innovate - Company Website
www.cskinnovate.com {
	# Automatically handles HTTPS with Let's Encrypt
	
	# Reverse proxy to Next.js app
	reverse_proxy localhost:3000
	
	# Enable gzip compression
	encode gzip
	
	# Security headers
	header {
		X-Frame-Options "SAMEORIGIN"
		X-Content-Type-Options "nosniff"
		X-XSS-Protection "1; mode=block"
		-Server
	}
}

# Redirect non-www to www for CSK
cskinnovate.com {
	redir https://www.cskinnovate.com{uri} permanent
}
